{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/admin/role-management/RoleTable.tsx"],"sourcesContent":["import { PencilIcon, ShieldCheckIcon, TrashIcon, UsersIcon } from '@heroicons/react/24/outline';\nimport React, { useMemo, useState } from 'react';\nimport { Permission, Role } from '../../../types/role';\nimport { PermissionGuard } from '../../rbac/PermissionGuard';\nimport { Button } from '../../ui/Button';\nimport { StatusIndicator } from '../../ui/StatusIndicator';\nimport { TextField } from '../../ui/TextField';\n\ninterface RoleTableProps {\n  roles: Role[];\n  permissions: Permission[];\n  isLoading: boolean;\n  onEditRole: (role: Role) => void;\n  onDeleteRole: (role: Role) => void;\n  onCreateRole: () => void;\n}\n\n/**\n * Enhanced table displaying all roles with search, filtering, and comprehensive actions.\n */\nconst RoleTable: React.FC<RoleTableProps> = ({\n  roles,\n  permissions: _permissions, // Prefix with underscore to indicate intentionally unused\n  isLoading,\n  onEditRole,\n  onDeleteRole,\n  onCreateRole: _onCreateRole, // Prefix with underscore to indicate intentionally unused\n}) => {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [filterType, setFilterType] = useState<'all' | 'system' | 'custom'>('all');\n  const [sortBy, setSortBy] = useState<'name' | 'created_at'>('name');\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc');\n\n  // Filter and sort roles\n  const filteredAndSortedRoles = useMemo(() => {\n    const filtered = roles.filter((role) => {\n      const matchesSearch =\n        role.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        (role.description || '').toLowerCase().includes(searchTerm.toLowerCase());\n\n      const matchesFilter =\n        filterType === 'all' ||\n        (filterType === 'system' && role.is_system_role) ||\n        (filterType === 'custom' && !role.is_system_role);\n\n      return matchesSearch && matchesFilter;\n    });\n\n    // Sort roles\n    filtered.sort((a, b) => {\n      let aValue: string | Date, bValue: string | Date;\n\n      switch (sortBy) {\n        case 'name':\n          aValue = a.name.toLowerCase();\n          bValue = b.name.toLowerCase();\n          break;\n        case 'created_at':\n          aValue = new Date(a.created_at || 0);\n          bValue = new Date(b.created_at || 0);\n          break;\n        default:\n          return 0;\n      }\n\n      if (sortOrder === 'asc') {\n        return aValue < bValue ? -1 : aValue > bValue ? 1 : 0;\n      } else {\n        return aValue > bValue ? -1 : aValue < bValue ? 1 : 0;\n      }\n    });\n\n    return filtered;\n  }, [roles, searchTerm, filterType, sortBy, sortOrder]);\n\n  const getRoleIcon = (role: Role): React.JSX.Element => {\n    if (role.is_system_role) {\n      return <ShieldCheckIcon className=\"h-5 w-5 text-blue-400\" />;\n    }\n    return <UsersIcon className=\"h-5 w-5 text-green-400\" />;\n  };\n\n  const getRoleTypeDisplay = (role: Role): string => {\n    return role.is_system_role ? 'System' : 'Custom';\n  };\n\n  const getPermissionCount = (role: Role): number => {\n    return role.permissions?.length ?? 0;\n  };\n\n  const formatDate = (dateString: string): string => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      year: 'numeric',\n      month: 'short',\n      day: 'numeric',\n    });\n  };\n\n  const getDisplayName = (role: Role): string => {\n    // Convert system_role enum to display name or use role name\n    return role.system_role.replace(/_/g, ' ').replace(/\\b\\w/g, (l) => l.toUpperCase());\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"bg-gray-800 rounded-lg border border-gray-700\">\n        <div className=\"p-6\">\n          <div className=\"animate-pulse\">\n            <div className=\"h-8 bg-gray-700 rounded w-1/4 mb-4\"></div>\n            <div className=\"space-y-3\">\n              {Array.from({ length: 5 }, (_, i) => (\n                <div key={i} className=\"h-16 bg-gray-700 rounded\"></div>\n              ))}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-gray-800 rounded-lg border border-gray-700\">\n      {/* Header with Search and Filters */}\n      <div className=\"p-6 border-b border-gray-700\">\n        <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0\">\n          <div className=\"flex-1 max-w-md\">\n            <TextField\n              value={searchTerm}\n              onChange={setSearchTerm}\n              placeholder=\"Search roles...\"\n              className=\"w-full\"\n            />\n          </div>\n\n          <div className=\"flex items-center space-x-4\">\n            {/* Filter Dropdown */}\n            <select\n              value={filterType}\n              onChange={(e) => {\n                setFilterType(e.target.value as 'all' | 'system' | 'custom');\n              }}\n              className=\"bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"all\">All Roles</option>\n              <option value=\"system\">System Roles</option>\n              <option value=\"custom\">Custom Roles</option>\n            </select>\n\n            {/* Sort Dropdown */}\n            <select\n              value={`${sortBy}-${sortOrder}`}\n              onChange={(e) => {\n                const [column, order] = e.target.value.split('-');\n                setSortBy(column as 'name' | 'created_at');\n                setSortOrder(order as 'asc' | 'desc');\n              }}\n              className=\"bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"name-asc\">Name (A-Z)</option>\n              <option value=\"name-desc\">Name (Z-A)</option>\n              <option value=\"created_at-desc\">Newest First</option>\n              <option value=\"created_at-asc\">Oldest First</option>\n            </select>\n          </div>\n        </div>\n\n        <div className=\"mt-4 text-sm text-gray-400\">\n          Showing {filteredAndSortedRoles.length} of {roles.length} roles\n        </div>\n      </div>\n\n      {/* Table */}\n      <div className=\"overflow-x-auto\">\n        <table className=\"w-full\">\n          <thead>\n            <tr className=\"border-b border-gray-700\">\n              <th className=\"text-left p-4 text-gray-300 font-medium\">Role</th>\n              <th className=\"text-left p-4 text-gray-300 font-medium\">Type</th>\n              <th className=\"text-left p-4 text-gray-300 font-medium\">Permissions</th>\n              <th className=\"text-left p-4 text-gray-300 font-medium\">Status</th>\n              <th className=\"text-left p-4 text-gray-300 font-medium\">Created</th>\n              <th className=\"text-right p-4 text-gray-300 font-medium\">Actions</th>\n            </tr>\n          </thead>\n          <tbody>\n            {filteredAndSortedRoles.length === 0 ? (\n              <tr>\n                <td colSpan={6} className=\"p-8 text-center text-gray-400\">\n                  {searchTerm || filterType !== 'all'\n                    ? 'No roles match your criteria'\n                    : 'No roles found'}\n                </td>\n              </tr>\n            ) : (\n              filteredAndSortedRoles.map((role) => (\n                <tr\n                  key={role.id}\n                  className=\"border-b border-gray-700 hover:bg-gray-700/50 transition-colors\"\n                >\n                  <td className=\"p-4\">\n                    <div className=\"flex items-center space-x-3\">\n                      {getRoleIcon(role)}\n                      <div>\n                        <div className=\"font-medium text-white\">{getDisplayName(role)}</div>\n                        <div className=\"text-sm text-gray-400\">{role.name}</div>\n                        {role.description && (\n                          <div className=\"text-xs text-gray-500 mt-1 max-w-xs truncate\">\n                            {role.description}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </td>\n\n                  <td className=\"p-4\">\n                    <span\n                      className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                        role.is_system_role\n                          ? 'bg-blue-900/50 text-blue-300 border border-blue-700'\n                          : 'bg-green-900/50 text-green-300 border border-green-700'\n                      }`}\n                    >\n                      {getRoleTypeDisplay(role)}\n                    </span>\n                  </td>\n\n                  <td className=\"p-4\">\n                    <div className=\"flex items-center space-x-2\">\n                      <ShieldCheckIcon className=\"h-4 w-4 text-gray-400\" />\n                      <span className=\"text-white\">{getPermissionCount(role)}</span>\n                    </div>\n                  </td>\n\n                  <td className=\"p-4\">\n                    <StatusIndicator\n                      status={role.is_active ? 'success' : 'warning'}\n                      label={role.is_active ? 'Active' : 'Inactive'}\n                    />\n                  </td>\n\n                  <td className=\"p-4\">\n                    <span className=\"text-gray-300 text-sm\">\n                      {role.created_at ? formatDate(role.created_at) : 'N/A'}\n                    </span>\n                  </td>\n\n                  <td className=\"p-4\">\n                    <div className=\"flex items-center justify-end space-x-2\">\n                      <PermissionGuard permission=\"role:update\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            onEditRole(role);\n                          }}\n                          leftIcon={<PencilIcon className=\"h-4 w-4\" />}\n                          className=\"text-blue-400 hover:text-blue-300\"\n                        >\n                          Edit\n                        </Button>\n                      </PermissionGuard>\n\n                      <PermissionGuard permission=\"role:delete\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            onDeleteRole(role);\n                          }}\n                          leftIcon={<TrashIcon className=\"h-4 w-4\" />}\n                          className=\"text-red-400 hover:text-red-300\"\n                          disabled={role.is_system_role}\n                        >\n                          Delete\n                        </Button>\n                      </PermissionGuard>\n                    </div>\n                  </td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Footer */}\n      <div className=\"p-4 border-t border-gray-700 bg-gray-800/50\">\n        <div className=\"flex items-center justify-between text-sm text-gray-400\">\n          <span>\n            {filteredAndSortedRoles.length} role{filteredAndSortedRoles.length !== 1 ? 's' : ''}{' '}\n            displayed\n          </span>\n          <div className=\"flex items-center space-x-4\">\n            <span>System roles cannot be deleted</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RoleTable;\n"],"names":["RoleTable","roles","permissions","_permissions","isLoading","onEditRole","onDeleteRole","onCreateRole","_onCreateRole","searchTerm","setSearchTerm","useState","filterType","setFilterType","sortBy","setSortBy","sortOrder","setSortOrder","filteredAndSortedRoles","useMemo","filtered","filter","role","matchesSearch","name","toLowerCase","includes","description","matchesFilter","is_system_role","sort","a","b","aValue","bValue","Date","created_at","getRoleIcon","ShieldCheckIcon","className","UsersIcon","getRoleTypeDisplay","getPermissionCount","length","formatDate","dateString","toLocaleDateString","year","month","day","getDisplayName","system_role","replace","l","toUpperCase","div","Array","from","_","i","TextField","value","onChange","placeholder","select","e","target","option","column","order","split","table","thead","tr","th","tbody","td","colSpan","map","span","StatusIndicator","status","is_active","label","PermissionGuard","permission","Button","variant","size","onClick","leftIcon","PencilIcon","TrashIcon","disabled","id"],"mappings":"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"}