{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/ui/__tests__/ColorModeToggle.test.tsx"],"sourcesContent":["/**\n * ColorModeToggle Component Tests\n * \n * Tests the enhanced ColorModeToggle component including:\n * - Basic toggle functionality\n * - Accessibility enhancements\n * - Theme transition integration\n * - Reduced motion support\n * - Screen reader announcements\n */\n\nimport React from 'react';\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport { ColorModeToggle } from '../ColorModeToggle';\nimport * as themeTransition from '../../../utils/themeTransition';\nimport * as accessibilityEnhancements from '../../../utils/accessibilityEnhancements';\n\n// Mock the theme transition utilities\njest.mock('../../../utils/themeTransition', () => ({\n  applyThemeWithTransition: jest.fn(),\n  useThemeTransition: jest.fn(() => ({\n    applyTheme: jest.fn(),\n    isTransitioning: jest.fn(() => false),\n  })),\n}));\n\n// Mock accessibility enhancements\njest.mock('../../../utils/accessibilityEnhancements', () => ({\n  accessibilityManager: {\n    announceToScreenReader: jest.fn(),\n    getUserPreferences: jest.fn(() => ({\n      motion: 'none',\n      verbosity: 'standard',\n    })),\n  },\n}));\n\n// Mock matchMedia for reduced motion detection\nObject.defineProperty(window, 'matchMedia', {\n  writable: true,\n  value: jest.fn().mockImplementation(query => ({\n    matches: query.includes('prefers-reduced-motion: reduce') ? false : false,\n    media: query,\n    onchange: null,\n    addListener: jest.fn(),\n    removeListener: jest.fn(),\n    addEventListener: jest.fn(),\n    removeEventListener: jest.fn(),\n    dispatchEvent: jest.fn(),\n  })),\n});\n\n// Mock the useTheme hook (assuming it exists in your theme context)\nconst mockUseTheme = {\n  theme: 'minimal',\n  colorMode: 'light',\n  setColorMode: jest.fn(),\n  setTheme: jest.fn(),\n};\n\njest.mock('../../../contexts/ThemeContext', () => ({\n  useTheme: () => mockUseTheme,\n}));\n\ndescribe('ColorModeToggle', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Basic Functionality', () => {\n    test('renders toggle button', () => {\n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      expect(button).toBeInTheDocument();\n      expect(button).toHaveAttribute('aria-label');\n    });\n\n    test('shows current color mode in aria-label', () => {\n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      const ariaLabel = button.getAttribute('aria-label');\n      expect(ariaLabel).toContain('light');\n    });\n\n    test('toggles color mode on click', async () => {\n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      await waitFor(() => {\n        expect(mockUseTheme.setColorMode).toHaveBeenCalledWith('dark');\n      });\n    });\n\n    test('applies theme transition on toggle', async () => {\n      const applyThemeSpy = jest.spyOn(themeTransition, 'applyThemeWithTransition');\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      await waitFor(() => {\n        expect(applyThemeSpy).toHaveBeenCalled();\n      });\n    });\n  });\n\n  describe('Accessibility Features', () => {\n    test('announces theme change to screen reader', async () => {\n      const announceSpy = jest.spyOn(\n        accessibilityEnhancements.accessibilityManager,\n        'announceToScreenReader'\n      );\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      await waitFor(() => {\n        expect(announceSpy).toHaveBeenCalledWith(\n          expect.stringContaining('dark mode')\n        );\n      });\n    });\n\n    test('is disabled during transition', async () => {\n      const mockIsTransitioning = jest.fn(() => true);\n      (themeTransition.useThemeTransition as jest.Mock).mockReturnValue({\n        applyTheme: jest.fn(),\n        isTransitioning: mockIsTransitioning,\n      });\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      expect(button).toBeDisabled();\n    });\n\n    test('provides descriptive aria-label', () => {\n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      const ariaLabel = button.getAttribute('aria-label');\n      \n      expect(ariaLabel).toMatch(/switch to \\w+ mode/i);\n    });\n\n    test('has proper keyboard accessibility', () => {\n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      \n      // Should be focusable\n      button.focus();\n      expect(document.activeElement).toBe(button);\n      \n      // Should respond to Enter key\n      fireEvent.keyDown(button, { key: 'Enter' });\n      expect(mockUseTheme.setColorMode).toHaveBeenCalled();\n      \n      // Should respond to Space key\n      jest.clearAllMocks();\n      fireEvent.keyDown(button, { key: ' ' });\n      expect(mockUseTheme.setColorMode).toHaveBeenCalled();\n    });\n  });\n\n  describe('Reduced Motion Support', () => {\n    test('respects reduced motion preference', async () => {\n      // Mock reduced motion preference\n      (window.matchMedia as jest.Mock).mockImplementation(query => ({\n        matches: query.includes('prefers-reduced-motion: reduce'),\n        media: query,\n        addEventListener: jest.fn(),\n        removeEventListener: jest.fn(),\n      }));\n\n      const applyThemeSpy = jest.spyOn(themeTransition, 'applyThemeWithTransition');\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      await waitFor(() => {\n        expect(applyThemeSpy).toHaveBeenCalledWith(\n          expect.any(String),\n          expect.any(String),\n          expect.objectContaining({\n            respectReducedMotion: true,\n          })\n        );\n      });\n    });\n\n    test('applies instant transition for reduced motion', async () => {\n      // Mock user settings for reduced motion\n      (accessibilityEnhancements.accessibilityManager.getUserPreferences as jest.Mock)\n        .mockReturnValue({\n          motion: 'none',\n          verbosity: 'standard',\n        });\n\n      const applyThemeSpy = jest.spyOn(themeTransition, 'applyThemeWithTransition');\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      await waitFor(() => {\n        expect(applyThemeSpy).toHaveBeenCalledWith(\n          expect.any(String),\n          expect.any(String),\n          expect.objectContaining({\n            duration: 0, // Instant transition\n          })\n        );\n      });\n    });\n  });\n\n  describe('Icon Display', () => {\n    test('shows appropriate icon for light mode', () => {\n      mockUseTheme.colorMode = 'light';\n      \n      render(<ColorModeToggle />);\n      \n      // Should show moon icon (to switch to dark)\n      const moonIcon = screen.getByTestId('moon-icon');\n      expect(moonIcon).toBeInTheDocument();\n    });\n\n    test('shows appropriate icon for dark mode', () => {\n      mockUseTheme.colorMode = 'dark';\n      \n      render(<ColorModeToggle />);\n      \n      // Should show sun icon (to switch to light)\n      const sunIcon = screen.getByTestId('sun-icon');\n      expect(sunIcon).toBeInTheDocument();\n    });\n\n    test('animates icon transition when not reduced motion', () => {\n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      // Icon should have transition styles\n      const icon = button.querySelector('[data-testid*=\"icon\"]');\n      expect(icon).toHaveStyle('transition: transform 0.3s ease-in-out');\n    });\n\n    test('skips icon animation for reduced motion', () => {\n      // Mock reduced motion setting\n      (accessibilityEnhancements.accessibilityManager.getUserPreferences as jest.Mock)\n        .mockReturnValue({\n          motion: 'none',\n          verbosity: 'standard',\n        });\n\n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      const icon = button.querySelector('[data-testid*=\"icon\"]');\n      \n      // Should not have transition styles\n      expect(icon).not.toHaveStyle('transition: transform 0.3s ease-in-out');\n    });\n  });\n\n  describe('Error Handling', () => {\n    test('handles theme transition errors gracefully', async () => {\n      const consoleSpy = jest.spyOn(console, 'error').mockImplementation();\n      const applyThemeSpy = jest.spyOn(themeTransition, 'applyThemeWithTransition')\n        .mockRejectedValue(new Error('Transition failed'));\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      await waitFor(() => {\n        expect(consoleSpy).toHaveBeenCalledWith(\n          expect.stringContaining('Theme transition failed'),\n          expect.any(Error)\n        );\n      });\n      \n      // Should still update the color mode\n      expect(mockUseTheme.setColorMode).toHaveBeenCalled();\n      \n      consoleSpy.mockRestore();\n    });\n\n    test('remains functional if accessibility manager fails', async () => {\n      const consoleSpy = jest.spyOn(console, 'error').mockImplementation();\n      jest.spyOn(accessibilityEnhancements.accessibilityManager, 'announceToScreenReader')\n        .mockImplementation(() => {\n          throw new Error('Screen reader failed');\n        });\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      fireEvent.click(button);\n      \n      // Should still toggle despite accessibility error\n      await waitFor(() => {\n        expect(mockUseTheme.setColorMode).toHaveBeenCalled();\n      });\n      \n      consoleSpy.mockRestore();\n    });\n  });\n\n  describe('Performance', () => {\n    test('debounces rapid clicks', async () => {\n      jest.useFakeTimers();\n      \n      render(<ColorModeToggle />);\n      \n      const button = screen.getByRole('button');\n      \n      // Click multiple times rapidly\n      fireEvent.click(button);\n      fireEvent.click(button);\n      fireEvent.click(button);\n      \n      // Fast forward timers\n      jest.runAllTimers();\n      \n      // Should only apply theme once despite multiple clicks\n      await waitFor(() => {\n        expect(mockUseTheme.setColorMode).toHaveBeenCalledTimes(1);\n      });\n      \n      jest.useRealTimers();\n    });\n\n    test('prevents memory leaks on unmount', () => {\n      const { unmount } = render(<ColorModeToggle />);\n      \n      // Should not throw on unmount\n      expect(() => unmount()).not.toThrow();\n    });\n  });\n\n  describe('Integration', () => {\n    test('works with different themes', async () => {\n      const themes = ['minimal', 'neo-brutalist', 'corporate'];\n      \n      for (const theme of themes) {\n        mockUseTheme.theme = theme;\n        \n        render(<ColorModeToggle />);\n        \n        const button = screen.getByRole('button');\n        fireEvent.click(button);\n        \n        await waitFor(() => {\n          expect(themeTransition.applyThemeWithTransition).toHaveBeenCalledWith(\n            theme,\n            expect.any(String),\n            expect.any(Object)\n          );\n        });\n        \n        // Clean up for next iteration\n        jest.clearAllMocks();\n      }\n    });\n\n    test('synchronizes with system theme preference', () => {\n      // Mock system preference change\n      const mediaQuery = {\n        matches: true,\n        media: '(prefers-color-scheme: dark)',\n        addEventListener: jest.fn(),\n        removeEventListener: jest.fn(),\n      };\n      \n      (window.matchMedia as jest.Mock).mockReturnValue(mediaQuery);\n      \n      render(<ColorModeToggle />);\n      \n      // Simulate system theme change\n      const changeHandler = mediaQuery.addEventListener.mock.calls\n        .find(call => call[0] === 'change')?.[1];\n      \n      if (changeHandler) {\n        changeHandler({ matches: true });\n        \n        expect(mockUseTheme.setColorMode).toHaveBeenCalledWith('dark');\n      }\n    });\n  });\n}); "],"names":["jest","mock","applyThemeWithTransition","fn","useThemeTransition","applyTheme","isTransitioning","accessibilityManager","announceToScreenReader","getUserPreferences","motion","verbosity","useTheme","mockUseTheme","Object","defineProperty","window","writable","value","mockImplementation","query","matches","includes","media","onchange","addListener","removeListener","addEventListener","removeEventListener","dispatchEvent","theme","colorMode","setColorMode","setTheme","describe","beforeEach","clearAllMocks","test","render","ColorModeToggle","button","screen","getByRole","expect","toBeInTheDocument","toHaveAttribute","ariaLabel","getAttribute","toContain","fireEvent","click","waitFor","toHaveBeenCalledWith","applyThemeSpy","spyOn","themeTransition","toHaveBeenCalled","announceSpy","accessibilityEnhancements","stringContaining","mockIsTransitioning","mockReturnValue","toBeDisabled","toMatch","focus","document","activeElement","toBe","keyDown","key","matchMedia","any","String","objectContaining","respectReducedMotion","duration","moonIcon","getByTestId","sunIcon","icon","querySelector","toHaveStyle","not","consoleSpy","console","mockRejectedValue","Error","mockRestore","useFakeTimers","runAllTimers","toHaveBeenCalledTimes","useRealTimers","unmount","toThrow","themes","mediaQuery","changeHandler","calls","find","call"],"mappings":"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"}