{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/charts/__tests__/BuildTimeTrendChart.test.tsx"],"sourcesContent":["/**\n * BuildTimeTrendChart Component Tests\n * \n * Simplified test suite covering basic functionality\n */\n\nimport React from 'react';\nimport { render, screen, fireEvent } from '@testing-library/react';\nimport '@testing-library/jest-dom';\nimport { subDays } from 'date-fns';\nimport BuildTimeTrendChart from '../BuildTimeTrendChart';\n\n// Mock the useResponsive hook\njest.mock('../../../hooks/useResponsive', () => ({\n  useResponsive: () => ({\n    isMobile: false,\n    isTablet: false,\n    isDesktop: true\n  })\n}));\n\n// Mock Recharts components\njest.mock('recharts', () => ({\n  LineChart: ({ children }: any) => children,\n  Line: ({ dataKey }: any) => `<Line dataKey=\"${dataKey}\" />`,\n  XAxis: ({ dataKey }: any) => `<XAxis dataKey=\"${dataKey}\" />`,\n  YAxis: () => '<YAxis />',\n  CartesianGrid: () => '<CartesianGrid />',\n  Tooltip: () => '<Tooltip />',\n  ResponsiveContainer: ({ children }: any) => children,\n  ReferenceLine: () => '<ReferenceLine />',\n  Dot: ({ fill }: any) => `<Dot fill=\"${fill}\" />`\n}));\n\n// Test data\nconst mockPipelineRuns = [\n  {\n    id: 1,\n    pipeline_id: 1,\n    run_number: 1,\n    status: 'success' as const,\n    started_at: subDays(new Date(), 5).toISOString(),\n    finished_at: subDays(new Date(), 5).toISOString(),\n    duration_seconds: 120,\n    branch: 'main'\n  },\n  {\n    id: 2,\n    pipeline_id: 1,\n    run_number: 2,\n    status: 'success' as const,\n    started_at: subDays(new Date(), 3).toISOString(),\n    finished_at: subDays(new Date(), 3).toISOString(),\n    duration_seconds: 150,\n    branch: 'main'\n  },\n  {\n    id: 3,\n    pipeline_id: 1,\n    run_number: 3,\n    status: 'success' as const,\n    started_at: subDays(new Date(), 1).toISOString(),\n    finished_at: subDays(new Date(), 1).toISOString(),\n    duration_seconds: 300,\n    branch: 'main'\n  }\n];\n\nconst mockPipelines = [\n  {\n    id: 1,\n    name: 'Frontend CI/CD',\n    runs: mockPipelineRuns\n  },\n  {\n    id: 2,\n    name: 'Backend CI/CD',\n    runs: [\n      {\n        id: 4,\n        pipeline_id: 2,\n        run_number: 1,\n        status: 'success' as const,\n        started_at: subDays(new Date(), 2).toISOString(),\n        finished_at: subDays(new Date(), 2).toISOString(),\n        duration_seconds: 180,\n        branch: 'main'\n      }\n    ]\n  }\n];\n\ndescribe('BuildTimeTrendChart', () => {\n  it('renders chart component', () => {\n    render(<BuildTimeTrendChart pipelines={mockPipelines} />);\n    \n    expect(screen.getByText('Build Time Trends')).toBeInTheDocument();\n  });\n\n  it('displays correct time range', () => {\n    render(<BuildTimeTrendChart pipelines={mockPipelines} timeRange={14} />);\n    \n    expect(screen.getByText(/Last 14 days/)).toBeInTheDocument();\n  });\n\n  it('shows average build time', () => {\n    render(<BuildTimeTrendChart pipelines={mockPipelines} />);\n    \n    expect(screen.getByText(/Average:/)).toBeInTheDocument();\n  });\n\n  it('handles empty pipelines', () => {\n    render(<BuildTimeTrendChart pipelines={[]} />);\n    \n    expect(screen.getByText('Build Time Trends')).toBeInTheDocument();\n    expect(screen.getByText(/Average:/)).toBeInTheDocument();\n    expect(screen.getByText(/0s/)).toBeInTheDocument();\n  });\n\n  it('toggles outliers visibility', () => {\n    render(<BuildTimeTrendChart pipelines={mockPipelines} />);\n    \n    const outliersButton = screen.getByRole('button', { name: /outliers/i });\n    expect(outliersButton).toBeInTheDocument();\n    \n    fireEvent.click(outliersButton);\n    expect(outliersButton).toHaveClass('bg-gray-100');\n  });\n\n  it('applies custom className', () => {\n    const customClass = 'custom-chart-class';\n    const { container } = render(\n      <BuildTimeTrendChart pipelines={mockPipelines} className={customClass} />\n    );\n    \n    expect(container.firstChild).toHaveClass(customClass);\n  });\n\n  it('handles different time ranges', () => {\n    const { rerender } = render(\n      <BuildTimeTrendChart pipelines={mockPipelines} timeRange={7} />\n    );\n    \n    expect(screen.getByText(/Last 7 days/)).toBeInTheDocument();\n    \n    rerender(<BuildTimeTrendChart pipelines={mockPipelines} timeRange={30} />);\n    expect(screen.getByText(/Last 30 days/)).toBeInTheDocument();\n  });\n\n  it('calculates trend direction', () => {\n    render(<BuildTimeTrendChart pipelines={mockPipelines} />);\n    \n    // Should show some trend indicator\n    const trendIndicators = ['Improving', 'Degrading', 'Stable'];\n    const hasTrendIndicator = trendIndicators.some(trend => \n      screen.queryByText(new RegExp(trend, 'i'))\n    );\n    expect(hasTrendIndicator).toBe(true);\n  });\n\n  it('shows legend with line descriptions', () => {\n    render(<BuildTimeTrendChart pipelines={mockPipelines} />);\n    \n    expect(screen.getByText('Average Duration')).toBeInTheDocument();\n    expect(screen.getByText('Median Duration')).toBeInTheDocument();\n  });\n\n  it('handles pipeline filtering', () => {\n    render(\n      <BuildTimeTrendChart \n        pipelines={mockPipelines} \n        selectedPipelineId={1}\n      />\n    );\n    \n    // Should still render the chart with filtered data\n    expect(screen.getByText('Build Time Trends')).toBeInTheDocument();\n  });\n}); "],"names":["jest","mock","useResponsive","isMobile","isTablet","isDesktop","LineChart","children","Line","dataKey","XAxis","YAxis","CartesianGrid","Tooltip","ResponsiveContainer","ReferenceLine","Dot","fill","mockPipelineRuns","id","pipeline_id","run_number","status","started_at","subDays","Date","toISOString","finished_at","duration_seconds","branch","mockPipelines","name","runs","describe","it","render","BuildTimeTrendChart","pipelines","expect","screen","getByText","toBeInTheDocument","timeRange","outliersButton","getByRole","fireEvent","click","toHaveClass","customClass","container","className","firstChild","rerender","trendIndicators","hasTrendIndicator","some","trend","queryByText","RegExp","toBe","selectedPipelineId"],"mappings":"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"}