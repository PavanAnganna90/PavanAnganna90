{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/auth/GitHubLoginButton.tsx"],"sourcesContent":["/**\n * GitHub OAuth login button component.\n * Provides secure OAuth initiation with GitHub's authorization service.\n */\n\nimport React from 'react';\n\n// OAuth configuration constants - using backend OAuth endpoint\nconst BACKEND_OAUTH_URL = 'http://localhost:8000/api/v1/auth/oauth/github/authorize';\nconst CLIENT_ID = (import.meta as any).env.VITE_GITHUB_CLIENT_ID || 'dev-client-id';\nconst REDIRECT_URI = `${window.location.origin}/auth/callback`;\nconst SCOPE = 'user:email read:user';\n\ninterface GitHubLoginButtonProps {\n  /** Additional CSS classes for styling */\n  className?: string;\n  /** Loading state for async operations */\n  isLoading?: boolean;\n  /** Callback fired when OAuth initiation starts */\n  onLoginStart?: () => void;\n  /** Button size variant */\n  size?: 'sm' | 'md' | 'lg';\n  /** Button style variant */\n  variant?: 'primary' | 'secondary' | 'outline';\n}\n\n/**\n * GitHubLoginButton Component\n * \n * Renders a secure GitHub OAuth login button that initiates the OAuth flow.\n * Uses design tokens for consistent styling and follows accessibility best practices.\n * \n * @param props - Component props\n * @returns JSX element representing the GitHub login button\n */\nexport const GitHubLoginButton: React.FC<GitHubLoginButtonProps> = ({\n  className = '',\n  isLoading = false,\n  onLoginStart,\n  size = 'md',\n  variant = 'primary',\n}) => {\n  /**\n   * Handle GitHub OAuth initiation via backend.\n   * Uses backend OAuth endpoint to get proper authorization URL.\n   */\n  const handleGitHubLogin = async (): Promise<void> => {\n    if (isLoading) return;\n\n    // Generate secure state parameter for CSRF protection\n    const state = btoa(JSON.stringify({\n      timestamp: Date.now(),\n      random: Math.random().toString(36).substring(2)\n    }));\n\n    // Store state in sessionStorage for validation on callback\n    sessionStorage.setItem('github_oauth_state', state);\n\n    // Callback for external handling\n    onLoginStart?.();\n\n    try {\n      // Get authorization URL from backend\n      const response = await fetch(`${BACKEND_OAUTH_URL}?redirect_uri=${encodeURIComponent(REDIRECT_URI)}&state=${encodeURIComponent(state)}`);\n      \n      if (!response.ok) {\n        throw new Error(`OAuth endpoint failed: ${response.status}`);\n      }\n\n      const data = await response.json();\n      \n      if (data.authorization_url) {\n        // Redirect to the authorization URL provided by backend\n        window.location.href = data.authorization_url;\n      } else {\n        console.error('No authorization URL received from backend');\n      }\n    } catch (error) {\n      console.error('OAuth initiation failed:', error);\n      // Fallback to direct GitHub OAuth if backend fails\n      const authUrl = new URL('https://github.com/login/oauth/authorize');\n      authUrl.searchParams.set('client_id', CLIENT_ID);\n      authUrl.searchParams.set('redirect_uri', REDIRECT_URI);\n      authUrl.searchParams.set('scope', SCOPE);\n      authUrl.searchParams.set('state', state);\n      authUrl.searchParams.set('allow_signup', 'true');\n      window.location.href = authUrl.toString();\n    }\n  };\n\n  // Generate CSS classes based on props using design tokens\n  const getButtonClasses = (): string => {\n    const baseClasses = [\n      'inline-flex',\n      'items-center',\n      'justify-center',\n      'font-medium',\n      'rounded-lg',\n      'transition-colors',\n      'focus:outline-none',\n      'focus:ring-2',\n      'focus:ring-offset-2',\n      'disabled:opacity-50',\n      'disabled:cursor-not-allowed',\n    ];\n\n    // Size variants using design tokens\n    const sizeClasses = {\n      sm: ['px-3', 'py-2', 'text-sm', 'gap-2'],\n      md: ['px-4', 'py-2.5', 'text-base', 'gap-2'],\n      lg: ['px-6', 'py-3', 'text-lg', 'gap-3'],\n    };\n\n    // Style variants using design tokens\n    const variantClasses = {\n      primary: [\n        'bg-neutral-900',\n        'text-neutral-0',\n        'hover:bg-neutral-800',\n        'focus:ring-neutral-500',\n        'border',\n        'border-neutral-900',\n      ],\n      secondary: [\n        'bg-neutral-100',\n        'text-neutral-900',\n        'hover:bg-neutral-200',\n        'focus:ring-neutral-400',\n        'border',\n        'border-neutral-300',\n      ],\n      outline: [\n        'bg-transparent',\n        'text-neutral-900',\n        'hover:bg-neutral-50',\n        'focus:ring-neutral-400',\n        'border',\n        'border-neutral-300',\n      ],\n    };\n\n    return [\n      ...baseClasses,\n      ...sizeClasses[size],\n      ...variantClasses[variant],\n      className,\n    ].join(' ');\n  };\n\n  return (\n    <button\n      type=\"button\"\n      onClick={handleGitHubLogin}\n      disabled={isLoading}\n      className={getButtonClasses()}\n      aria-label=\"Sign in with GitHub\"\n      data-testid=\"github-login-button\"\n    >\n      {/* GitHub Icon SVG */}\n      <svg\n        className={`${size === 'sm' ? 'w-4 h-4' : size === 'lg' ? 'w-6 h-6' : 'w-5 h-5'}`}\n        viewBox=\"0 0 24 24\"\n        fill=\"currentColor\"\n        aria-hidden=\"true\"\n      >\n        <path\n          fillRule=\"evenodd\"\n          d=\"M12 0C5.374 0 0 5.373 0 12 0 17.302 3.438 21.8 8.207 23.387c.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z\"\n          clipRule=\"evenodd\"\n        />\n      </svg>\n\n      {/* Button Text */}\n      <span>\n        {isLoading ? 'Connecting...' : 'Continue with GitHub'}\n      </span>\n\n      {/* Loading Spinner */}\n      {isLoading && (\n        <svg\n          className={`animate-spin ${size === 'sm' ? 'w-4 h-4' : size === 'lg' ? 'w-6 h-6' : 'w-5 h-5'}`}\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          aria-hidden=\"true\"\n        >\n          <circle\n            className=\"opacity-25\"\n            cx=\"12\"\n            cy=\"12\"\n            r=\"10\"\n            stroke=\"currentColor\"\n            strokeWidth=\"4\"\n          />\n          <path\n            className=\"opacity-75\"\n            fill=\"currentColor\"\n            d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n          />\n        </svg>\n      )}\n    </button>\n  );\n};\n\nexport default GitHubLoginButton; "],"names":["GitHubLoginButton","BACKEND_OAUTH_URL","CLIENT_ID","env","VITE_GITHUB_CLIENT_ID","REDIRECT_URI","window","location","origin","SCOPE","className","isLoading","onLoginStart","size","variant","handleGitHubLogin","state","btoa","JSON","stringify","timestamp","Date","now","random","Math","toString","substring","sessionStorage","setItem","response","fetch","encodeURIComponent","ok","Error","status","data","json","authorization_url","href","console","error","authUrl","URL","searchParams","set","getButtonClasses","baseClasses","sizeClasses","sm","md","lg","variantClasses","primary","secondary","outline","join","button","type","onClick","disabled","aria-label","data-testid","svg","viewBox","fill","aria-hidden","path","fillRule","d","clipRule","span","circle","cx","cy","r","stroke","strokeWidth"],"mappings":"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"}