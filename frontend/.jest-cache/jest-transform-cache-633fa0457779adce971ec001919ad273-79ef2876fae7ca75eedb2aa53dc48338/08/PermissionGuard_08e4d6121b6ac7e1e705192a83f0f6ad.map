{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/rbac/PermissionGuard.tsx"],"sourcesContent":["/**\n * Permission Guard Component\n *\n * Conditionally renders children based on user permissions\n */\n\nimport React from 'react';\nimport { useAuth } from '../../contexts/AuthContext';\n\ninterface PermissionGuardProps {\n  permission?: string;\n  permissions?: string[];\n  role?: string;\n  roles?: string[];\n  resource?: string;\n  action?: string;\n  organizationId?: string;\n  requireAll?: boolean;\n  fallback?: React.ReactNode;\n  children: React.ReactNode;\n}\n\nexport function PermissionGuard({\n  permission,\n  permissions,\n  role,\n  roles,\n  resource,\n  action,\n  organizationId,\n  requireAll = false,\n  fallback = null,\n  children,\n}: PermissionGuardProps) {\n  const { hasPermission, hasRole, isAuthenticated, user } = useAuth();\n\n  // If not authenticated, don't render\n  if (!isAuthenticated || !user) {\n    return <>{fallback}</>;\n  }\n\n  // Check permissions\n  let hasAccess = true;\n\n  // Single permission check\n  if (permission) {\n    hasAccess = hasPermission(permission, organizationId);\n  }\n\n  // Multiple permissions check\n  if (permissions && permissions.length > 0) {\n    hasAccess = requireAll\n      ? permissions.every((p) => hasPermission(p, organizationId))\n      : permissions.some((p) => hasPermission(p, organizationId));\n  }\n\n  // Single role check\n  if (role) {\n    hasAccess = hasAccess && hasRole(role);\n  }\n\n  // Multiple roles check\n  if (roles && roles.length > 0) {\n    hasAccess =\n      hasAccess && (requireAll ? roles.every((r) => hasRole(r)) : roles.some((r) => hasRole(r)));\n  }\n\n  // Resource/action check\n  if (resource && action) {\n    hasAccess = hasAccess && hasPermission(`${action}:${resource}`, organizationId);\n  }\n\n  return hasAccess ? <>{children}</> : <>{fallback}</>;\n}\n\n// Convenience components for common use cases\nexport function AdminOnly({\n  children,\n  fallback = null,\n}: {\n  children: React.ReactNode;\n  fallback?: React.ReactNode;\n}) {\n  return (\n    <PermissionGuard roles={['admin', 'organization_owner', 'super_admin']} fallback={fallback}>\n      {children}\n    </PermissionGuard>\n  );\n}\n\nexport function RoleGuard({\n  role,\n  roles,\n  children,\n  fallback = null,\n}: {\n  role?: string;\n  roles?: string[];\n  children: React.ReactNode;\n  fallback?: React.ReactNode;\n}) {\n  return (\n    <PermissionGuard role={role} roles={roles} fallback={fallback}>\n      {children}\n    </PermissionGuard>\n  );\n}\n\nexport function ResourceGuard({\n  resource,\n  action,\n  organizationId,\n  children,\n  fallback = null,\n}: {\n  resource: string;\n  action: string;\n  organizationId?: string;\n  children: React.ReactNode;\n  fallback?: React.ReactNode;\n}) {\n  return (\n    <PermissionGuard\n      resource={resource}\n      action={action}\n      organizationId={organizationId}\n      fallback={fallback}\n    >\n      {children}\n    </PermissionGuard>\n  );\n}\n"],"names":["AdminOnly","PermissionGuard","ResourceGuard","RoleGuard","permission","permissions","role","roles","resource","action","organizationId","requireAll","fallback","children","hasPermission","hasRole","isAuthenticated","user","useAuth","hasAccess","length","every","p","some","r"],"mappings":"AAAA;;;;CAIC;;;;;;;;;;;IAwEeA,SAAS;eAATA;;IAtDAC,eAAe;eAAfA;;IAsFAC,aAAa;eAAbA;;IAlBAC,SAAS;eAATA;;;;8DApFE;6BACM;;;;;;AAejB,SAASF,gBAAgB,EAC9BG,UAAU,EACVC,WAAW,EACXC,IAAI,EACJC,KAAK,EACLC,QAAQ,EACRC,MAAM,EACNC,cAAc,EACdC,aAAa,KAAK,EAClBC,WAAW,IAAI,EACfC,QAAQ,EACa;IACrB,MAAM,EAAEC,aAAa,EAAEC,OAAO,EAAEC,eAAe,EAAEC,IAAI,EAAE,GAAGC,IAAAA,oBAAO;IAEjE,qCAAqC;IACrC,IAAI,CAACF,mBAAmB,CAACC,MAAM;QAC7B,qBAAO;sBAAGL;;IACZ;IAEA,oBAAoB;IACpB,IAAIO,YAAY;IAEhB,0BAA0B;IAC1B,IAAIf,YAAY;QACde,YAAYL,cAAcV,YAAYM;IACxC;IAEA,6BAA6B;IAC7B,IAAIL,eAAeA,YAAYe,MAAM,GAAG,GAAG;QACzCD,YAAYR,aACRN,YAAYgB,KAAK,CAAC,CAACC,IAAMR,cAAcQ,GAAGZ,mBAC1CL,YAAYkB,IAAI,CAAC,CAACD,IAAMR,cAAcQ,GAAGZ;IAC/C;IAEA,oBAAoB;IACpB,IAAIJ,MAAM;QACRa,YAAYA,aAAaJ,QAAQT;IACnC;IAEA,uBAAuB;IACvB,IAAIC,SAASA,MAAMa,MAAM,GAAG,GAAG;QAC7BD,YACEA,aAAcR,CAAAA,aAAaJ,MAAMc,KAAK,CAAC,CAACG,IAAMT,QAAQS,MAAMjB,MAAMgB,IAAI,CAAC,CAACC,IAAMT,QAAQS,GAAE;IAC5F;IAEA,wBAAwB;IACxB,IAAIhB,YAAYC,QAAQ;QACtBU,YAAYA,aAAaL,cAAc,GAAGL,OAAO,CAAC,EAAED,UAAU,EAAEE;IAClE;IAEA,OAAOS,0BAAY;kBAAGN;uBAAe;kBAAGD;;AAC1C;AAGO,SAASZ,UAAU,EACxBa,QAAQ,EACRD,WAAW,IAAI,EAIhB;IACC,qBACE,qBAACX;QAAgBM,OAAO;YAAC;YAAS;YAAsB;SAAc;QAAEK,UAAUA;kBAC/EC;;AAGP;AAEO,SAASV,UAAU,EACxBG,IAAI,EACJC,KAAK,EACLM,QAAQ,EACRD,WAAW,IAAI,EAMhB;IACC,qBACE,qBAACX;QAAgBK,MAAMA;QAAMC,OAAOA;QAAOK,UAAUA;kBAClDC;;AAGP;AAEO,SAASX,cAAc,EAC5BM,QAAQ,EACRC,MAAM,EACNC,cAAc,EACdG,QAAQ,EACRD,WAAW,IAAI,EAOhB;IACC,qBACE,qBAACX;QACCO,UAAUA;QACVC,QAAQA;QACRC,gBAAgBA;QAChBE,UAAUA;kBAETC;;AAGP"}