37ee097d7b576c9af0459b5987a63b64
/**
 * Permission Guard Component
 *
 * Conditionally renders children based on user permissions
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    AdminOnly: function() {
        return AdminOnly;
    },
    PermissionGuard: function() {
        return PermissionGuard;
    },
    ResourceGuard: function() {
        return ResourceGuard;
    },
    RoleGuard: function() {
        return RoleGuard;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _AuthContext = require("../../contexts/AuthContext");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function PermissionGuard({ permission, permissions, role, roles, resource, action, organizationId, requireAll = false, fallback = null, children }) {
    const { hasPermission, hasRole, isAuthenticated, user } = (0, _AuthContext.useAuth)();
    // If not authenticated, don't render
    if (!isAuthenticated || !user) {
        return /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
            children: fallback
        });
    }
    // Check permissions
    let hasAccess = true;
    // Single permission check
    if (permission) {
        hasAccess = hasPermission(permission, organizationId);
    }
    // Multiple permissions check
    if (permissions && permissions.length > 0) {
        hasAccess = requireAll ? permissions.every((p)=>hasPermission(p, organizationId)) : permissions.some((p)=>hasPermission(p, organizationId));
    }
    // Single role check
    if (role) {
        hasAccess = hasAccess && hasRole(role);
    }
    // Multiple roles check
    if (roles && roles.length > 0) {
        hasAccess = hasAccess && (requireAll ? roles.every((r)=>hasRole(r)) : roles.some((r)=>hasRole(r)));
    }
    // Resource/action check
    if (resource && action) {
        hasAccess = hasAccess && hasPermission(`${action}:${resource}`, organizationId);
    }
    return hasAccess ? /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
        children: children
    }) : /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
        children: fallback
    });
}
function AdminOnly({ children, fallback = null }) {
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(PermissionGuard, {
        roles: [
            'admin',
            'organization_owner',
            'super_admin'
        ],
        fallback: fallback,
        children: children
    });
}
function RoleGuard({ role, roles, children, fallback = null }) {
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(PermissionGuard, {
        role: role,
        roles: roles,
        fallback: fallback,
        children: children
    });
}
function ResourceGuard({ resource, action, organizationId, children, fallback = null }) {
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(PermissionGuard, {
        resource: resource,
        action: action,
        organizationId: organizationId,
        fallback: fallback,
        children: children
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9wYXZhbi9EZXNrdG9wL0Rldm9wcy1hcHAtZGV2LWN1cnNvci9mcm9udGVuZC9zcmMvY29tcG9uZW50cy9yYmFjL1Blcm1pc3Npb25HdWFyZC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQZXJtaXNzaW9uIEd1YXJkIENvbXBvbmVudFxuICpcbiAqIENvbmRpdGlvbmFsbHkgcmVuZGVycyBjaGlsZHJlbiBiYXNlZCBvbiB1c2VyIHBlcm1pc3Npb25zXG4gKi9cblxuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tICcuLi8uLi9jb250ZXh0cy9BdXRoQ29udGV4dCc7XG5cbmludGVyZmFjZSBQZXJtaXNzaW9uR3VhcmRQcm9wcyB7XG4gIHBlcm1pc3Npb24/OiBzdHJpbmc7XG4gIHBlcm1pc3Npb25zPzogc3RyaW5nW107XG4gIHJvbGU/OiBzdHJpbmc7XG4gIHJvbGVzPzogc3RyaW5nW107XG4gIHJlc291cmNlPzogc3RyaW5nO1xuICBhY3Rpb24/OiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkPzogc3RyaW5nO1xuICByZXF1aXJlQWxsPzogYm9vbGVhbjtcbiAgZmFsbGJhY2s/OiBSZWFjdC5SZWFjdE5vZGU7XG4gIGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBQZXJtaXNzaW9uR3VhcmQoe1xuICBwZXJtaXNzaW9uLFxuICBwZXJtaXNzaW9ucyxcbiAgcm9sZSxcbiAgcm9sZXMsXG4gIHJlc291cmNlLFxuICBhY3Rpb24sXG4gIG9yZ2FuaXphdGlvbklkLFxuICByZXF1aXJlQWxsID0gZmFsc2UsXG4gIGZhbGxiYWNrID0gbnVsbCxcbiAgY2hpbGRyZW4sXG59OiBQZXJtaXNzaW9uR3VhcmRQcm9wcykge1xuICBjb25zdCB7IGhhc1Blcm1pc3Npb24sIGhhc1JvbGUsIGlzQXV0aGVudGljYXRlZCwgdXNlciB9ID0gdXNlQXV0aCgpO1xuXG4gIC8vIElmIG5vdCBhdXRoZW50aWNhdGVkLCBkb24ndCByZW5kZXJcbiAgaWYgKCFpc0F1dGhlbnRpY2F0ZWQgfHwgIXVzZXIpIHtcbiAgICByZXR1cm4gPD57ZmFsbGJhY2t9PC8+O1xuICB9XG5cbiAgLy8gQ2hlY2sgcGVybWlzc2lvbnNcbiAgbGV0IGhhc0FjY2VzcyA9IHRydWU7XG5cbiAgLy8gU2luZ2xlIHBlcm1pc3Npb24gY2hlY2tcbiAgaWYgKHBlcm1pc3Npb24pIHtcbiAgICBoYXNBY2Nlc3MgPSBoYXNQZXJtaXNzaW9uKHBlcm1pc3Npb24sIG9yZ2FuaXphdGlvbklkKTtcbiAgfVxuXG4gIC8vIE11bHRpcGxlIHBlcm1pc3Npb25zIGNoZWNrXG4gIGlmIChwZXJtaXNzaW9ucyAmJiBwZXJtaXNzaW9ucy5sZW5ndGggPiAwKSB7XG4gICAgaGFzQWNjZXNzID0gcmVxdWlyZUFsbFxuICAgICAgPyBwZXJtaXNzaW9ucy5ldmVyeSgocCkgPT4gaGFzUGVybWlzc2lvbihwLCBvcmdhbml6YXRpb25JZCkpXG4gICAgICA6IHBlcm1pc3Npb25zLnNvbWUoKHApID0+IGhhc1Blcm1pc3Npb24ocCwgb3JnYW5pemF0aW9uSWQpKTtcbiAgfVxuXG4gIC8vIFNpbmdsZSByb2xlIGNoZWNrXG4gIGlmIChyb2xlKSB7XG4gICAgaGFzQWNjZXNzID0gaGFzQWNjZXNzICYmIGhhc1JvbGUocm9sZSk7XG4gIH1cblxuICAvLyBNdWx0aXBsZSByb2xlcyBjaGVja1xuICBpZiAocm9sZXMgJiYgcm9sZXMubGVuZ3RoID4gMCkge1xuICAgIGhhc0FjY2VzcyA9XG4gICAgICBoYXNBY2Nlc3MgJiYgKHJlcXVpcmVBbGwgPyByb2xlcy5ldmVyeSgocikgPT4gaGFzUm9sZShyKSkgOiByb2xlcy5zb21lKChyKSA9PiBoYXNSb2xlKHIpKSk7XG4gIH1cblxuICAvLyBSZXNvdXJjZS9hY3Rpb24gY2hlY2tcbiAgaWYgKHJlc291cmNlICYmIGFjdGlvbikge1xuICAgIGhhc0FjY2VzcyA9IGhhc0FjY2VzcyAmJiBoYXNQZXJtaXNzaW9uKGAke2FjdGlvbn06JHtyZXNvdXJjZX1gLCBvcmdhbml6YXRpb25JZCk7XG4gIH1cblxuICByZXR1cm4gaGFzQWNjZXNzID8gPD57Y2hpbGRyZW59PC8+IDogPD57ZmFsbGJhY2t9PC8+O1xufVxuXG4vLyBDb252ZW5pZW5jZSBjb21wb25lbnRzIGZvciBjb21tb24gdXNlIGNhc2VzXG5leHBvcnQgZnVuY3Rpb24gQWRtaW5Pbmx5KHtcbiAgY2hpbGRyZW4sXG4gIGZhbGxiYWNrID0gbnVsbCxcbn06IHtcbiAgY2hpbGRyZW46IFJlYWN0LlJlYWN0Tm9kZTtcbiAgZmFsbGJhY2s/OiBSZWFjdC5SZWFjdE5vZGU7XG59KSB7XG4gIHJldHVybiAoXG4gICAgPFBlcm1pc3Npb25HdWFyZCByb2xlcz17WydhZG1pbicsICdvcmdhbml6YXRpb25fb3duZXInLCAnc3VwZXJfYWRtaW4nXX0gZmFsbGJhY2s9e2ZhbGxiYWNrfT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L1Blcm1pc3Npb25HdWFyZD5cbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFJvbGVHdWFyZCh7XG4gIHJvbGUsXG4gIHJvbGVzLFxuICBjaGlsZHJlbixcbiAgZmFsbGJhY2sgPSBudWxsLFxufToge1xuICByb2xlPzogc3RyaW5nO1xuICByb2xlcz86IHN0cmluZ1tdO1xuICBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlO1xuICBmYWxsYmFjaz86IFJlYWN0LlJlYWN0Tm9kZTtcbn0pIHtcbiAgcmV0dXJuIChcbiAgICA8UGVybWlzc2lvbkd1YXJkIHJvbGU9e3JvbGV9IHJvbGVzPXtyb2xlc30gZmFsbGJhY2s9e2ZhbGxiYWNrfT5cbiAgICAgIHtjaGlsZHJlbn1cbiAgICA8L1Blcm1pc3Npb25HdWFyZD5cbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFJlc291cmNlR3VhcmQoe1xuICByZXNvdXJjZSxcbiAgYWN0aW9uLFxuICBvcmdhbml6YXRpb25JZCxcbiAgY2hpbGRyZW4sXG4gIGZhbGxiYWNrID0gbnVsbCxcbn06IHtcbiAgcmVzb3VyY2U6IHN0cmluZztcbiAgYWN0aW9uOiBzdHJpbmc7XG4gIG9yZ2FuaXphdGlvbklkPzogc3RyaW5nO1xuICBjaGlsZHJlbjogUmVhY3QuUmVhY3ROb2RlO1xuICBmYWxsYmFjaz86IFJlYWN0LlJlYWN0Tm9kZTtcbn0pIHtcbiAgcmV0dXJuIChcbiAgICA8UGVybWlzc2lvbkd1YXJkXG4gICAgICByZXNvdXJjZT17cmVzb3VyY2V9XG4gICAgICBhY3Rpb249e2FjdGlvbn1cbiAgICAgIG9yZ2FuaXphdGlvbklkPXtvcmdhbml6YXRpb25JZH1cbiAgICAgIGZhbGxiYWNrPXtmYWxsYmFja31cbiAgICA+XG4gICAgICB7Y2hpbGRyZW59XG4gICAgPC9QZXJtaXNzaW9uR3VhcmQ+XG4gICk7XG59XG4iXSwibmFtZXMiOlsiQWRtaW5Pbmx5IiwiUGVybWlzc2lvbkd1YXJkIiwiUmVzb3VyY2VHdWFyZCIsIlJvbGVHdWFyZCIsInBlcm1pc3Npb24iLCJwZXJtaXNzaW9ucyIsInJvbGUiLCJyb2xlcyIsInJlc291cmNlIiwiYWN0aW9uIiwib3JnYW5pemF0aW9uSWQiLCJyZXF1aXJlQWxsIiwiZmFsbGJhY2siLCJjaGlsZHJlbiIsImhhc1Blcm1pc3Npb24iLCJoYXNSb2xlIiwiaXNBdXRoZW50aWNhdGVkIiwidXNlciIsInVzZUF1dGgiLCJoYXNBY2Nlc3MiLCJsZW5ndGgiLCJldmVyeSIsInAiLCJzb21lIiwiciJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Q0FJQzs7Ozs7Ozs7Ozs7SUF3RWVBLFNBQVM7ZUFBVEE7O0lBdERBQyxlQUFlO2VBQWZBOztJQXNGQUMsYUFBYTtlQUFiQTs7SUFsQkFDLFNBQVM7ZUFBVEE7Ozs7OERBcEZFOzZCQUNNOzs7Ozs7QUFlakIsU0FBU0YsZ0JBQWdCLEVBQzlCRyxVQUFVLEVBQ1ZDLFdBQVcsRUFDWEMsSUFBSSxFQUNKQyxLQUFLLEVBQ0xDLFFBQVEsRUFDUkMsTUFBTSxFQUNOQyxjQUFjLEVBQ2RDLGFBQWEsS0FBSyxFQUNsQkMsV0FBVyxJQUFJLEVBQ2ZDLFFBQVEsRUFDYTtJQUNyQixNQUFNLEVBQUVDLGFBQWEsRUFBRUMsT0FBTyxFQUFFQyxlQUFlLEVBQUVDLElBQUksRUFBRSxHQUFHQyxJQUFBQSxvQkFBTztJQUVqRSxxQ0FBcUM7SUFDckMsSUFBSSxDQUFDRixtQkFBbUIsQ0FBQ0MsTUFBTTtRQUM3QixxQkFBTztzQkFBR0w7O0lBQ1o7SUFFQSxvQkFBb0I7SUFDcEIsSUFBSU8sWUFBWTtJQUVoQiwwQkFBMEI7SUFDMUIsSUFBSWYsWUFBWTtRQUNkZSxZQUFZTCxjQUFjVixZQUFZTTtJQUN4QztJQUVBLDZCQUE2QjtJQUM3QixJQUFJTCxlQUFlQSxZQUFZZSxNQUFNLEdBQUcsR0FBRztRQUN6Q0QsWUFBWVIsYUFDUk4sWUFBWWdCLEtBQUssQ0FBQyxDQUFDQyxJQUFNUixjQUFjUSxHQUFHWixtQkFDMUNMLFlBQVlrQixJQUFJLENBQUMsQ0FBQ0QsSUFBTVIsY0FBY1EsR0FBR1o7SUFDL0M7SUFFQSxvQkFBb0I7SUFDcEIsSUFBSUosTUFBTTtRQUNSYSxZQUFZQSxhQUFhSixRQUFRVDtJQUNuQztJQUVBLHVCQUF1QjtJQUN2QixJQUFJQyxTQUFTQSxNQUFNYSxNQUFNLEdBQUcsR0FBRztRQUM3QkQsWUFDRUEsYUFBY1IsQ0FBQUEsYUFBYUosTUFBTWMsS0FBSyxDQUFDLENBQUNHLElBQU1ULFFBQVFTLE1BQU1qQixNQUFNZ0IsSUFBSSxDQUFDLENBQUNDLElBQU1ULFFBQVFTLEdBQUU7SUFDNUY7SUFFQSx3QkFBd0I7SUFDeEIsSUFBSWhCLFlBQVlDLFFBQVE7UUFDdEJVLFlBQVlBLGFBQWFMLGNBQWMsR0FBR0wsT0FBTyxDQUFDLEVBQUVELFVBQVUsRUFBRUU7SUFDbEU7SUFFQSxPQUFPUywwQkFBWTtrQkFBR047dUJBQWU7a0JBQUdEOztBQUMxQztBQUdPLFNBQVNaLFVBQVUsRUFDeEJhLFFBQVEsRUFDUkQsV0FBVyxJQUFJLEVBSWhCO0lBQ0MscUJBQ0UscUJBQUNYO1FBQWdCTSxPQUFPO1lBQUM7WUFBUztZQUFzQjtTQUFjO1FBQUVLLFVBQVVBO2tCQUMvRUM7O0FBR1A7QUFFTyxTQUFTVixVQUFVLEVBQ3hCRyxJQUFJLEVBQ0pDLEtBQUssRUFDTE0sUUFBUSxFQUNSRCxXQUFXLElBQUksRUFNaEI7SUFDQyxxQkFDRSxxQkFBQ1g7UUFBZ0JLLE1BQU1BO1FBQU1DLE9BQU9BO1FBQU9LLFVBQVVBO2tCQUNsREM7O0FBR1A7QUFFTyxTQUFTWCxjQUFjLEVBQzVCTSxRQUFRLEVBQ1JDLE1BQU0sRUFDTkMsY0FBYyxFQUNkRyxRQUFRLEVBQ1JELFdBQVcsSUFBSSxFQU9oQjtJQUNDLHFCQUNFLHFCQUFDWDtRQUNDTyxVQUFVQTtRQUNWQyxRQUFRQTtRQUNSQyxnQkFBZ0JBO1FBQ2hCRSxVQUFVQTtrQkFFVEM7O0FBR1AifQ==