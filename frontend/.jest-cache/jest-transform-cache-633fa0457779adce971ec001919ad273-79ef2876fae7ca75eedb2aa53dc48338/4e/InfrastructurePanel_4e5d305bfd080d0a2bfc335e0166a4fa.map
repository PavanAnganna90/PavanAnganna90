{"version":3,"names":["InfrastructurePanel","cov_15xq20jp6","f","panelVisibility","s","_SettingsContext","useSettings","queryClient","_reactquery","useQueryClient","infraPerms","_usePermissions","useInfrastructurePermissions","data","resources","isLoading","error","refetch","useQuery","queryKey","queryFn","_infrastructureApi","fetchInfrastructure","enabled","canViewInfrastructure","restartMutation","useMutation","mutationFn","restartResource","onSuccess","invalidateQueries","deleteMutation","deleteResource","infrastructure","b","handleRestart","id","_analytics","trackEvent","resourceId","_auditLogApi","logAuditEvent","mutate","handleDelete","_jsxruntime","jsxs","className","jsx","panel","String","_EmptyState","default","illustration","title","description","action","label","onClick","length","map","res","name","type","region","status","cost","last_updated","_PermissionGuard","PermissionGuard","permission"],"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/components/dashboard/InfrastructurePanel.tsx"],"sourcesContent":["import React from 'react';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { fetchInfrastructure, restartResource, deleteResource } from '../../services/infrastructureApi';\nimport { useSettings } from '../../contexts/SettingsContext';\nimport { useInfrastructurePermissions } from '../../hooks/usePermissions';\nimport { PermissionGuard } from '../rbac/PermissionGuard';\nimport { trackEvent } from '../../utils/analytics';\nimport { logAuditEvent } from '../../services/auditLogApi';\nimport EmptyState from '../ui/EmptyState';\n\nexport default function InfrastructurePanel() {\n  const { panelVisibility } = useSettings();\n  const queryClient = useQueryClient();\n  const infraPerms = useInfrastructurePermissions();\n  const { data: resources, isLoading, error, refetch } = useQuery({ \n    queryKey: ['infrastructure'], \n    queryFn: fetchInfrastructure,\n    enabled: infraPerms.canViewInfrastructure\n  });\n\n  const restartMutation = useMutation({\n    mutationFn: restartResource,\n    onSuccess: () => queryClient.invalidateQueries({ queryKey: ['infrastructure'] })\n  });\n  const deleteMutation = useMutation({\n    mutationFn: deleteResource,\n    onSuccess: () => queryClient.invalidateQueries({ queryKey: ['infrastructure'] })\n  });\n\n  if (!panelVisibility.infrastructure) return null;\n  \n  // Check permissions first\n  if (!infraPerms.canViewInfrastructure) return null;\n\n  const handleRestart = async (id: number) => {\n    trackEvent('restart_resource', { resourceId: id });\n    await logAuditEvent('restart_resource', 'admin', { resourceId: id });\n    restartMutation.mutate(id);\n  };\n  const handleDelete = async (id: number) => {\n    trackEvent('delete_resource', { resourceId: id });\n    await logAuditEvent('delete_resource', 'admin', { resourceId: id });\n    deleteMutation.mutate(id);\n  };\n\n  if (isLoading) {\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-500 mb-2\" aria-label=\"Loading infrastructure\" />\n        <span className=\"text-gray-500\">Loading infrastructure...</span>\n      </section>\n    );\n  }\n  if (error) {\n    trackEvent('error', { panel: 'Infrastructure', error: String(error) });\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <EmptyState\n          illustration=\"mascot\"\n          title=\"Error Loading Infrastructure\"\n          description=\"We couldn't load infrastructure. Please try again.\"\n          action={{ label: 'Retry', onClick: refetch }}\n        />\n      </section>\n    );\n  }\n  if (!resources?.length) {\n    return (\n      <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 min-h-[320px] items-center justify-center\">\n        <EmptyState\n          illustration=\"mascot\"\n          title=\"No Infrastructure\"\n          description=\"No resources found.\"\n          action={{ label: 'Refresh', onClick: refetch }}\n        />\n      </section>\n    );\n  }\n  return (\n    <section className=\"bg-white/80 dark:bg-gray-900/80 rounded-xl shadow-lg p-6 flex flex-col gap-6 relative overflow-hidden min-h-[320px]\">\n      <div className=\"font-medium mb-2\">Infrastructure Resources</div>\n      <ul className=\"space-y-3\">\n        {resources.map((res: any) => (\n          <li key={res.id} className=\"flex flex-col md:flex-row md:items-center gap-2 bg-gray-50 dark:bg-gray-800 rounded-lg p-4\">\n            <div className=\"flex-1\">\n              <div className=\"font-semibold text-blue-600\">{res.name} ({res.type})</div>\n              <div className=\"text-gray-800 dark:text-gray-100\">Region: {res.region} | Status: {res.status}</div>\n              <div className=\"text-xs text-gray-400\">Cost: ${res.cost} | Last updated: {res.last_updated}</div>\n            </div>\n            <div className=\"flex gap-2 mt-2 md:mt-0\">\n              <PermissionGuard permission=\"manage_infrastructure\">\n                <button\n                  onClick={() => handleRestart(res.id)}\n                  className=\"px-3 py-1 rounded bg-yellow-600 text-white font-medium hover:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-400 transition\"\n                  aria-label={`Restart resource ${res.id}`}\n                >\n                  Restart\n                </button>\n              </PermissionGuard>\n              <PermissionGuard permission=\"manage_infrastructure\">\n                <button\n                  onClick={() => handleDelete(res.id)}\n                  className=\"px-3 py-1 rounded bg-red-600 text-white font-medium hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400 transition\"\n                  aria-label={`Delete resource ${res.id}`}\n                >\n                  Delete\n                </button>\n              </PermissionGuard>\n            </div>\n          </li>\n        ))}\n      </ul>\n    </section>\n  );\n} "],"mappings":"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","ignoreList":[]}