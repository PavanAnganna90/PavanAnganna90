{"version":3,"sources":["/Users/pavan/Desktop/Devops-app-dev-cursor/frontend/src/tests/components/teams/TeamList.test.tsx"],"sourcesContent":["import React from 'react';\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\nimport { vi, describe, it, expect, beforeEach } from 'vitest';\nimport { TeamList } from '@/components/teams/TeamList';\nimport { teamApi } from '@/services/teamApi';\nimport { Team, TeamFilter } from '@/types/team';\n\n// Mock the team API\nvi.mock('@/services/teamApi', () => ({\n  teamApi: {\n    getTeams: vi.fn(),\n  },\n}));\n\n// Mock UI components\nvi.mock('@/componen../ui', () => ({\n  Button: ({ children, onClick, className, ...props }: any) => (\n    <button onClick={onClick} className={className} {...props}>\n      {children}\n    </button>\n  ),\n}));\n\nvi.mock('@/components/ui/StatusIndicator', () => ({\n  StatusIndicator: ({ status }: { status: string }) => (\n    <span data-testid=\"status-indicator\">{status}</span>\n  ),\n}));\n\nconst mockTeams: Team[] = [\n  {\n    id: 1,\n    name: 'Development Team',\n    display_name: 'Development Team',\n    description: 'Main development team',\n    slug: 'dev-team',\n    is_active: true,\n    member_count: 5,\n    settings: {\n      allow_external_invites: true,\n      require_admin_approval: false,\n      default_member_role: 'MEMBER' as any,\n      visibility: 'private',\n      notifications: {\n        email: true,\n        slack: false,\n        webhook: false,\n      },\n    },\n    permissions: {\n      repository_access: true,\n      deployment_access: true,\n      monitoring_access: true,\n      cost_view_access: false,\n      settings_access: true,\n    },\n    created_at: '2024-01-01T00:00:00Z',\n    updated_at: '2024-01-01T00:00:00Z',\n  },\n  {\n    id: 2,\n    name: 'Design Team',\n    display_name: 'Design Team',\n    description: 'UI/UX design team',\n    slug: 'design-team',\n    is_active: true,\n    member_count: 3,\n    settings: {\n      allow_external_invites: false,\n      require_admin_approval: true,\n      default_member_role: 'VIEWER' as any,\n      visibility: 'public',\n      notifications: {\n        email: true,\n        slack: true,\n        webhook: false,\n      },\n    },\n    permissions: {\n      repository_access: false,\n      deployment_access: false,\n      monitoring_access: true,\n      cost_view_access: false,\n      settings_access: false,\n    },\n    created_at: '2024-01-02T00:00:00Z',\n    updated_at: '2024-01-02T00:00:00Z',\n  },\n];\n\nconst mockProps = {\n  onCreateTeam: vi.fn(),\n  onEditTeam: vi.fn(),\n  onDeleteTeam: vi.fn(),\n  onViewTeam: vi.fn(),\n};\n\ndescribe('TeamList', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n    (teamApi.getTeams as any).mockResolvedValue({\n      teams: mockTeams,\n      total: mockTeams.length,\n      page: 1,\n      page_size: 10,\n      total_pages: 1,\n    });\n  });\n\n  it('renders team list with teams', async () => {\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      expect(screen.getByText('Development Team')).toBeInTheDocument();\n      expect(screen.getByText('Design Team')).toBeInTheDocument();\n    });\n\n    expect(screen.getByText('5 members')).toBeInTheDocument();\n    expect(screen.getByText('3 members')).toBeInTheDocument();\n  });\n\n  it('shows loading state initially', () => {\n    (teamApi.getTeams as any).mockImplementation(() => new Promise(() => {}));\n    render(<TeamList {...mockProps} />);\n\n    expect(screen.getByText('Loading teams...')).toBeInTheDocument();\n  });\n\n  it('shows empty state when no teams', async () => {\n    (teamApi.getTeams as any).mockResolvedValue({\n      teams: [],\n      total: 0,\n      page: 1,\n      page_size: 10,\n      total_pages: 0,\n    });\n\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      expect(screen.getByText('No teams found')).toBeInTheDocument();\n    });\n  });\n\n  it('handles search functionality', async () => {\n    render(<TeamList {...mockProps} />);\n\n    const searchInput = screen.getByPlaceholderText('Search teams...');\n    fireEvent.change(searchInput, { target: { value: 'Development' } });\n\n    await waitFor(() => {\n      expect(teamApi.getTeams).toHaveBeenCalledWith(\n        expect.objectContaining({\n          search: 'Development',\n        })\n      );\n    });\n  });\n\n  it('handles filter changes', async () => {\n    render(<TeamList {...mockProps} />);\n\n    // Wait for initial load\n    await waitFor(() => {\n      expect(screen.getByText('Development Team')).toBeInTheDocument();\n    });\n\n    const statusFilter = screen.getByDisplayValue('all');\n    fireEvent.change(statusFilter, { target: { value: 'active' } });\n\n    await waitFor(() => {\n      expect(teamApi.getTeams).toHaveBeenCalledWith(\n        expect.objectContaining({\n          status: 'active',\n        })\n      );\n    });\n  });\n\n  it('handles pagination', async () => {\n    render(<TeamList {...mockProps} />);\n\n    // Wait for initial load\n    await waitFor(() => {\n      expect(screen.getByText('Development Team')).toBeInTheDocument();\n    });\n\n    const nextButton = screen.getByRole('button', { name: /next/i });\n    fireEvent.click(nextButton);\n\n    await waitFor(() => {\n      expect(teamApi.getTeams).toHaveBeenCalledWith(\n        expect.objectContaining({\n          page: 2,\n        })\n      );\n    });\n  });\n\n  it('calls onCreateTeam when create button is clicked', async () => {\n    render(<TeamList {...mockProps} />);\n\n    const createButton = screen.getByRole('button', { name: /create team/i });\n    fireEvent.click(createButton);\n\n    expect(mockProps.onCreateTeam).toHaveBeenCalled();\n  });\n\n  it('calls onEditTeam when edit button is clicked', async () => {\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      expect(screen.getByText('Development Team')).toBeInTheDocument();\n    });\n\n    const editButtons = screen.getAllByRole('button', { name: /edit/i });\n    fireEvent.click(editButtons[0]);\n\n    expect(mockProps.onEditTeam).toHaveBeenCalledWith(mockTeams[0]);\n  });\n\n  it('calls onViewTeam when view button is clicked', async () => {\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      expect(screen.getByText('Development Team')).toBeInTheDocument();\n    });\n\n    const viewButtons = screen.getAllByRole('button', { name: /view/i });\n    fireEvent.click(viewButtons[0]);\n\n    expect(mockProps.onViewTeam).toHaveBeenCalledWith(mockTeams[0]);\n  });\n\n  it('handles API errors gracefully', async () => {\n    const consoleError = vi.spyOn(console, 'error').mockImplementation(() => {});\n    (teamApi.getTeams as any).mockRejectedValue(new Error('API Error'));\n\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      expect(screen.getByText(/failed to load teams/i)).toBeInTheDocument();\n    });\n\n    consoleError.mockRestore();\n  });\n\n  it('displays team status indicators correctly', async () => {\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      const statusIndicators = screen.getAllByTestId('status-indicator');\n      expect(statusIndicators).toHaveLength(mockTeams.length);\n      statusIndicators.forEach(indicator => {\n        expect(indicator).toHaveTextContent('active');\n      });\n    });\n  });\n\n  it('shows team visibility badges', async () => {\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      expect(screen.getByText('Private')).toBeInTheDocument();\n      expect(screen.getByText('Public')).toBeInTheDocument();\n    });\n  });\n\n  it('displays correct member counts', async () => {\n    render(<TeamList {...mockProps} />);\n\n    await waitFor(() => {\n      expect(screen.getByText('5 members')).toBeInTheDocument();\n      expect(screen.getByText('3 members')).toBeInTheDocument();\n    });\n  });\n}); "],"names":["vi","mock","teamApi","getTeams","fn","Button","children","onClick","className","props","button","StatusIndicator","status","span","data-testid","mockTeams","id","name","display_name","description","slug","is_active","member_count","settings","allow_external_invites","require_admin_approval","default_member_role","visibility","notifications","email","slack","webhook","permissions","repository_access","deployment_access","monitoring_access","cost_view_access","settings_access","created_at","updated_at","mockProps","onCreateTeam","onEditTeam","onDeleteTeam","onViewTeam","describe","beforeEach","clearAllMocks","mockResolvedValue","teams","total","length","page","page_size","total_pages","it","render","TeamList","waitFor","expect","screen","getByText","toBeInTheDocument","mockImplementation","Promise","searchInput","getByPlaceholderText","fireEvent","change","target","value","toHaveBeenCalledWith","objectContaining","search","statusFilter","getByDisplayValue","nextButton","getByRole","click","createButton","toHaveBeenCalled","editButtons","getAllByRole","viewButtons","consoleError","spyOn","console","mockRejectedValue","Error","mockRestore","statusIndicators","getAllByTestId","toHaveLength","forEach","indicator","toHaveTextContent"],"mappings":";;;;;8DAAkB;wBACiC;wBACE;0BAC5B;yBACD;;;;;;AAGxB,oBAAoB;AACpBA,UAAE,CAACC,IAAI,CAAC,sBAAsB,IAAO,CAAA;QACnCC,SAAS;YACPC,UAAUH,UAAE,CAACI,EAAE;QACjB;IACF,CAAA;AAEA,qBAAqB;AACrBJ,UAAE,CAACC,IAAI,CAAC,mBAAmB,IAAO,CAAA;QAChCI,QAAQ,CAAC,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,SAAS,EAAE,GAAGC,OAAY,iBACtD,qBAACC;gBAAOH,SAASA;gBAASC,WAAWA;gBAAY,GAAGC,KAAK;0BACtDH;;IAGP,CAAA;AAEAN,UAAE,CAACC,IAAI,CAAC,mCAAmC,IAAO,CAAA;QAChDU,iBAAiB,CAAC,EAAEC,MAAM,EAAsB,iBAC9C,qBAACC;gBAAKC,eAAY;0BAAoBF;;IAE1C,CAAA;AAEA,MAAMG,YAAoB;IACxB;QACEC,IAAI;QACJC,MAAM;QACNC,cAAc;QACdC,aAAa;QACbC,MAAM;QACNC,WAAW;QACXC,cAAc;QACdC,UAAU;YACRC,wBAAwB;YACxBC,wBAAwB;YACxBC,qBAAqB;YACrBC,YAAY;YACZC,eAAe;gBACbC,OAAO;gBACPC,OAAO;gBACPC,SAAS;YACX;QACF;QACAC,aAAa;YACXC,mBAAmB;YACnBC,mBAAmB;YACnBC,mBAAmB;YACnBC,kBAAkB;YAClBC,iBAAiB;QACnB;QACAC,YAAY;QACZC,YAAY;IACd;IACA;QACEvB,IAAI;QACJC,MAAM;QACNC,cAAc;QACdC,aAAa;QACbC,MAAM;QACNC,WAAW;QACXC,cAAc;QACdC,UAAU;YACRC,wBAAwB;YACxBC,wBAAwB;YACxBC,qBAAqB;YACrBC,YAAY;YACZC,eAAe;gBACbC,OAAO;gBACPC,OAAO;gBACPC,SAAS;YACX;QACF;QACAC,aAAa;YACXC,mBAAmB;YACnBC,mBAAmB;YACnBC,mBAAmB;YACnBC,kBAAkB;YAClBC,iBAAiB;QACnB;QACAC,YAAY;QACZC,YAAY;IACd;CACD;AAED,MAAMC,YAAY;IAChBC,cAAczC,UAAE,CAACI,EAAE;IACnBsC,YAAY1C,UAAE,CAACI,EAAE;IACjBuC,cAAc3C,UAAE,CAACI,EAAE;IACnBwC,YAAY5C,UAAE,CAACI,EAAE;AACnB;AAEAyC,IAAAA,gBAAQ,EAAC,YAAY;IACnBC,IAAAA,kBAAU,EAAC;QACT9C,UAAE,CAAC+C,aAAa;QACf7C,gBAAO,CAACC,QAAQ,CAAS6C,iBAAiB,CAAC;YAC1CC,OAAOlC;YACPmC,OAAOnC,UAAUoC,MAAM;YACvBC,MAAM;YACNC,WAAW;YACXC,aAAa;QACf;IACF;IAEAC,IAAAA,UAAE,EAAC,gCAAgC;QACjCC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,qBAAqBC,iBAAiB;YAC9DH,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,gBAAgBC,iBAAiB;QAC3D;QAEAH,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,cAAcC,iBAAiB;QACvDH,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,cAAcC,iBAAiB;IACzD;IAEAP,IAAAA,UAAE,EAAC,iCAAiC;QACjCrD,gBAAO,CAACC,QAAQ,CAAS4D,kBAAkB,CAAC,IAAM,IAAIC,QAAQ,KAAO;QACtER,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9BmB,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,qBAAqBC,iBAAiB;IAChE;IAEAP,IAAAA,UAAE,EAAC,mCAAmC;QACnCrD,gBAAO,CAACC,QAAQ,CAAS6C,iBAAiB,CAAC;YAC1CC,OAAO,EAAE;YACTC,OAAO;YACPE,MAAM;YACNC,WAAW;YACXC,aAAa;QACf;QAEAE,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,mBAAmBC,iBAAiB;QAC9D;IACF;IAEAP,IAAAA,UAAE,EAAC,gCAAgC;QACjCC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMyB,cAAcL,cAAM,CAACM,oBAAoB,CAAC;QAChDC,iBAAS,CAACC,MAAM,CAACH,aAAa;YAAEI,QAAQ;gBAAEC,OAAO;YAAc;QAAE;QAEjE,MAAMZ,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACzD,gBAAO,CAACC,QAAQ,EAAEoE,oBAAoB,CAC3CZ,cAAM,CAACa,gBAAgB,CAAC;gBACtBC,QAAQ;YACV;QAEJ;IACF;IAEAlB,IAAAA,UAAE,EAAC,0BAA0B;QAC3BC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,wBAAwB;QACxB,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,qBAAqBC,iBAAiB;QAChE;QAEA,MAAMY,eAAed,cAAM,CAACe,iBAAiB,CAAC;QAC9CR,iBAAS,CAACC,MAAM,CAACM,cAAc;YAAEL,QAAQ;gBAAEC,OAAO;YAAS;QAAE;QAE7D,MAAMZ,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACzD,gBAAO,CAACC,QAAQ,EAAEoE,oBAAoB,CAC3CZ,cAAM,CAACa,gBAAgB,CAAC;gBACtB5D,QAAQ;YACV;QAEJ;IACF;IAEA2C,IAAAA,UAAE,EAAC,sBAAsB;QACvBC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,wBAAwB;QACxB,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,qBAAqBC,iBAAiB;QAChE;QAEA,MAAMc,aAAahB,cAAM,CAACiB,SAAS,CAAC,UAAU;YAAE5D,MAAM;QAAQ;QAC9DkD,iBAAS,CAACW,KAAK,CAACF;QAEhB,MAAMlB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACzD,gBAAO,CAACC,QAAQ,EAAEoE,oBAAoB,CAC3CZ,cAAM,CAACa,gBAAgB,CAAC;gBACtBpB,MAAM;YACR;QAEJ;IACF;IAEAG,IAAAA,UAAE,EAAC,oDAAoD;QACrDC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMuC,eAAenB,cAAM,CAACiB,SAAS,CAAC,UAAU;YAAE5D,MAAM;QAAe;QACvEkD,iBAAS,CAACW,KAAK,CAACC;QAEhBpB,IAAAA,cAAM,EAACnB,UAAUC,YAAY,EAAEuC,gBAAgB;IACjD;IAEAzB,IAAAA,UAAE,EAAC,gDAAgD;QACjDC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,qBAAqBC,iBAAiB;QAChE;QAEA,MAAMmB,cAAcrB,cAAM,CAACsB,YAAY,CAAC,UAAU;YAAEjE,MAAM;QAAQ;QAClEkD,iBAAS,CAACW,KAAK,CAACG,WAAW,CAAC,EAAE;QAE9BtB,IAAAA,cAAM,EAACnB,UAAUE,UAAU,EAAE6B,oBAAoB,CAACxD,SAAS,CAAC,EAAE;IAChE;IAEAwC,IAAAA,UAAE,EAAC,gDAAgD;QACjDC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,qBAAqBC,iBAAiB;QAChE;QAEA,MAAMqB,cAAcvB,cAAM,CAACsB,YAAY,CAAC,UAAU;YAAEjE,MAAM;QAAQ;QAClEkD,iBAAS,CAACW,KAAK,CAACK,WAAW,CAAC,EAAE;QAE9BxB,IAAAA,cAAM,EAACnB,UAAUI,UAAU,EAAE2B,oBAAoB,CAACxD,SAAS,CAAC,EAAE;IAChE;IAEAwC,IAAAA,UAAE,EAAC,iCAAiC;QAClC,MAAM6B,eAAepF,UAAE,CAACqF,KAAK,CAACC,SAAS,SAASvB,kBAAkB,CAAC,KAAO;QACzE7D,gBAAO,CAACC,QAAQ,CAASoF,iBAAiB,CAAC,IAAIC,MAAM;QAEtDhC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,0BAA0BC,iBAAiB;QACrE;QAEAsB,aAAaK,WAAW;IAC1B;IAEAlC,IAAAA,UAAE,EAAC,6CAA6C;QAC9CC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZ,MAAMgC,mBAAmB9B,cAAM,CAAC+B,cAAc,CAAC;YAC/ChC,IAAAA,cAAM,EAAC+B,kBAAkBE,YAAY,CAAC7E,UAAUoC,MAAM;YACtDuC,iBAAiBG,OAAO,CAACC,CAAAA;gBACvBnC,IAAAA,cAAM,EAACmC,WAAWC,iBAAiB,CAAC;YACtC;QACF;IACF;IAEAxC,IAAAA,UAAE,EAAC,gCAAgC;QACjCC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,YAAYC,iBAAiB;YACrDH,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,WAAWC,iBAAiB;QACtD;IACF;IAEAP,IAAAA,UAAE,EAAC,kCAAkC;QACnCC,IAAAA,cAAM,gBAAC,qBAACC,kBAAQ;YAAE,GAAGjB,SAAS;;QAE9B,MAAMkB,IAAAA,eAAO,EAAC;YACZC,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,cAAcC,iBAAiB;YACvDH,IAAAA,cAAM,EAACC,cAAM,CAACC,SAAS,CAAC,cAAcC,iBAAiB;QACzD;IACF;AACF"}